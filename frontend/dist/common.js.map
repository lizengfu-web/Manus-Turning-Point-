{"version":3,"file":"common.js","mappings":"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","sources":["webpack://zhuanjiao-yizhan-miniprogram/._src_api_auth.ts","webpack://zhuanjiao-yizhan-miniprogram/._src_api_config.ts","webpack://zhuanjiao-yizhan-miniprogram/._src_api_request.ts","webpack://zhuanjiao-yizhan-miniprogram/._src_pages_guide_data.ts","webpack://zhuanjiao-yizhan-miniprogram/._src_store_user.ts"],"sourcesContent":["import { post } from './request';\r\nimport Taro from '@tarojs/taro';\r\nimport { TOKEN_KEY, USER_INFO_KEY, API_BASE_URL } from './config';\r\n\r\nexport interface LoginParams {\r\n  code: string;\r\n  userInfo?: {\r\n    nickName: string;\r\n    avatarUrl: string;\r\n  };\r\n}\r\n\r\nexport interface LoginResponse {\r\n  token: string;\r\n  user: {\r\n    id: number;\r\n    openId: string;\r\n    nickName: string;\r\n    avatarUrl: string;\r\n    userType: string;\r\n  };\r\n}\r\n\r\n/**\r\n * 微信登录\r\n */\r\nexport async function wxLogin(params: LoginParams): Promise<LoginResponse> {\r\n  try {\r\n    console.log('[wxLogin] Starting login with code:', params.code?.substring(0, 10) + '...');\r\n    console.log('[wxLogin] API_BASE_URL:', API_BASE_URL);\r\n    \r\n    // 使用封装好的 request 工具类\r\n    const result = await post<LoginResponse>('/auth/login', params, true);\r\n    \r\n    // 保存 token 和用户信息\r\n    Taro.setStorageSync(TOKEN_KEY, result.token);\r\n    Taro.setStorageSync(USER_INFO_KEY, result.user);\r\n    \r\n    console.log('[wxLogin] Login successful');\r\n    return result;\r\n  } catch (error: any) {\r\n    console.error('[wxLogin] Error:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n/**\r\n * 获取当前用户信息\r\n */\r\nexport function getCurrentUser() {\r\n  return Taro.getStorageSync(USER_INFO_KEY);\r\n}\r\n\r\n/**\r\n * 退出登录\r\n */\r\nexport function logout() {\r\n  Taro.removeStorageSync(TOKEN_KEY);\r\n  Taro.removeStorageSync(USER_INFO_KEY);\r\n  Taro.reLaunch({ url: '/pages/index/index' });\r\n}\r\n\r\n/**\r\n * 检查是否已登录\r\n */\r\nexport function isLoggedIn(): boolean {\r\n  const token = Taro.getStorageSync(TOKEN_KEY);\r\n  return !!token;\r\n}\r\n\r\n/**\r\n * 获取用户信息\r\n */\r\nexport async function getUserInfo() {\r\n  try {\r\n    const token = Taro.getStorageSync(TOKEN_KEY);\r\n    if (!token) {\r\n      throw new Error('未登录');\r\n    }\r\n\r\n    return await get('/auth/user', null, true);\r\n  } catch (error: any) {\r\n    console.error('获取用户信息错误:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n/**\r\n * 编辑用户信息\r\n */\r\nexport async function updateUserInfo(userInfo: {\r\n  nickName?: string;\r\n  avatarUrl?: string;\r\n  userType?: string;\r\n  province?: string;\r\n  city?: string;\r\n  workYears?: number;\r\n}) {\r\n  try {\r\n    const token = Taro.getStorageSync(TOKEN_KEY);\r\n    if (!token) {\r\n      throw new Error('未登录');\r\n    }\r\n\r\n    const updatedUser = await post('/auth/user/update', userInfo, true);\r\n    Taro.setStorageSync(USER_INFO_KEY, updatedUser);\r\n    return updatedUser;\r\n  } catch (error: any) {\r\n    console.error('编辑用户信息错误:', error);\r\n    throw error;\r\n  }\r\n}\r\n","// API 配置\r\n// 本地开发：使用本地 IP 地址（不能使用 localhost）\r\n// 请将 YOUR_LOCAL_IP 替换为您电脑的局域网 IP 地址\r\nexport const API_BASE_URL = 'http://192.168.31.20:8080/api';\r\nexport const WEB_BASE_URL = 'http://192.168.31.20:8080';\r\n\r\n// 请求超时时间\r\nexport const REQUEST_TIMEOUT = 30000;\r\n\r\n// Token 存储 key\r\nexport const TOKEN_KEY = 'auth_token';\r\n\r\n// 用户信息存储 key\r\nexport const USER_INFO_KEY = 'user_info';\r\n","import Taro from '@tarojs/taro';\r\nimport { API_BASE_URL, REQUEST_TIMEOUT, TOKEN_KEY } from './config';\r\n\r\ninterface RequestOptions {\r\n  url: string;\r\n  method?: 'GET' | 'POST' | 'PUT' | 'DELETE';\r\n  data?: any;\r\n  header?: any;\r\n  showLoading?: boolean;\r\n  loadingText?: string;\r\n}\r\n\r\ninterface Response<T = any> {\r\n  code: number;\r\n  data: T;\r\n  message: string;\r\n}\r\n\r\n/**\r\n * 网络请求封装\r\n */\r\nexport async function request<T = any>(options: RequestOptions): Promise<T> {\r\n  const {\r\n    url,\r\n    method = 'GET',\r\n    data,\r\n    header = {},\r\n    showLoading = false,\r\n    loadingText = '加载中...'\r\n  } = options;\r\n\r\n  // 显示加载提示\r\n  if (showLoading) {\r\n    Taro.showLoading({ title: loadingText, mask: true });\r\n  }\r\n\r\n  try {\r\n    // 获取 token\r\n    const token = Taro.getStorageSync(TOKEN_KEY);\r\n\r\n    // 确保路径拼接正确\r\n    const requestUrl = url.startsWith('http') ? url : `${API_BASE_URL}${url.startsWith('/') ? '' : '/'}${url}`;\r\n\r\n    // 发起请求\r\n    const response = await Taro.request({\r\n      url: requestUrl,\r\n      method,\r\n      data,\r\n      header: {\r\n        'Content-Type': 'application/json',\r\n        'Authorization': token ? `Bearer ${token}` : '',\r\n        ...header\r\n      },\r\n      timeout: REQUEST_TIMEOUT\r\n    });\r\n\r\n    // 隐藏加载提示\r\n    if (showLoading) {\r\n      Taro.hideLoading();\r\n    }\r\n\r\n    const result = response.data as any;\r\n    \r\n    // 处理响应\r\n    if (response.statusCode === 200) {\r\n      // 适配后端返回格式：{ success: true, data: { ... } } 或 { code: 200, data: { ... } }\r\n      if (result.success === true || result.code === 0 || result.code === 200) {\r\n        return result.data;\r\n      } else if (result.code === 401) {\r\n        // 未登录或 token 失效\r\n        Taro.removeStorageSync(TOKEN_KEY);\r\n        Taro.showToast({\r\n          title: '请先登录',\r\n          icon: 'none',\r\n          duration: 2000\r\n        });\r\n        // 跳转到登录页\r\n        setTimeout(() => {\r\n          Taro.reLaunch({ url: '/pages/index/index' });\r\n        }, 2000);\r\n        throw new Error('未登录');\r\n      } else {\r\n        Taro.showToast({\r\n          title: result.message || '请求失败',\r\n          icon: 'none',\r\n          duration: 2000\r\n        });\r\n        throw new Error(result.message || '请求失败');\r\n      }\r\n    } else {\r\n      Taro.showToast({\r\n        title: '网络请求失败',\r\n        icon: 'none',\r\n        duration: 2000\r\n      });\r\n      throw new Error('网络请求失败');\r\n    }\r\n  } catch (error: any) {\r\n    // 隐藏加载提示\r\n    if (showLoading) {\r\n      Taro.hideLoading();\r\n    }\r\n\r\n    // 处理错误\r\n    console.error('API 请求错误:', error);\r\n    \r\n    if (error.errMsg) {\r\n      if (error.errMsg.includes('timeout')) {\r\n        const timeoutError = new Error('请求超时，请检查网络');\r\n        throw timeoutError;\r\n      } else if (error.errMsg.includes('fail')) {\r\n        // 提供更详细的错误信息\r\n        let errorMsg = '网络连接失败';\r\n        if (error.errMsg.includes('request:fail')) {\r\n          errorMsg = '无法连接到服务器，请检查：\\n1. 网络连接\\n2. 服务器地址配置\\n3. 微信开发者工具中关闭域名校验';\r\n        }\r\n        const failError = new Error(errorMsg);\r\n        throw failError;\r\n      }\r\n    }\r\n\r\n    throw error;\r\n  }\r\n}\r\n\r\n/**\r\n * GET 请求\r\n */\r\nexport function get<T = any>(url: string, data?: any, showLoading = false): Promise<T> {\r\n  return request<T>({ url, method: 'GET', data, showLoading });\r\n}\r\n\r\n/**\r\n * POST 请求\r\n */\r\nexport function post<T = any>(url: string, data?: any, showLoading = false): Promise<T> {\r\n  return request<T>({ url, method: 'POST', data, showLoading });\r\n}\r\n\r\n/**\r\n * PUT 请求\r\n */\r\nexport function put<T = any>(url: string, data?: any, showLoading = false): Promise<T> {\r\n  return request<T>({ url, method: 'PUT', data, showLoading });\r\n}\r\n\r\n/**\r\n * DELETE 请求\r\n */\r\nexport function del<T = any>(url: string, data?: any, showLoading = false): Promise<T> {\r\n  return request<T>({\r\n    url,\r\n    method: 'DELETE',\r\n    data,\r\n    showLoading\r\n  });\r\n}\r\n\r\n/**\r\n * tRPC 请求封装（支持 mutation）\r\n */\r\nexport async function trpcMutation<T = any>(procedure: string, input: any, showLoading = false): Promise<T> {\r\n  if (showLoading) {\r\n    Taro.showLoading({ title: '加载中...', mask: true });\r\n  }\r\n\r\n  try {\r\n    const token = Taro.getStorageSync(TOKEN_KEY);\r\n    \r\n    // tRPC 使用 batch 格式\r\n    const response = await Taro.request({\r\n      url: `${API_BASE_URL}/api/trpc/${procedure}?batch=1`,\r\n      method: 'POST',\r\n      data: { \"0\": input },\r\n      header: {\r\n        'Content-Type': 'application/json',\r\n        'Authorization': token ? `Bearer ${token}` : '',\r\n      },\r\n      timeout: REQUEST_TIMEOUT\r\n    });\r\n\r\n    if (showLoading) {\r\n      Taro.hideLoading();\r\n    }\r\n\r\n    if (response.statusCode === 200) {\r\n      const result = response.data as any;\r\n      // tRPC batch 响应格式是数组\r\n      if (Array.isArray(result) && result[0]) {\r\n        const firstResult = result[0];\r\n        if (firstResult.result && firstResult.result.data) {\r\n          return firstResult.result.data.json || firstResult.result.data;\r\n        } else if (firstResult.error) {\r\n          throw new Error(firstResult.error.message || '请求失败');\r\n        }\r\n      }\r\n      return result;\r\n    } else {\r\n      throw new Error(`HTTP ${response.statusCode}`);\r\n    }\r\n  } catch (error: any) {\r\n    if (showLoading) {\r\n      Taro.hideLoading();\r\n    }\r\n    console.error('tRPC 请求错误:', error);\r\n    throw error;\r\n  }\r\n}","export const GUIDES_DATA = [\r\n  {\r\n    id: 'unemployment-claim',\r\n    title: '失业保险金申领攻略',\r\n    desc: '手把手教你如何在线申领失业金，包括所需材料和流程。',\r\n    tag: '政策解读',\r\n    content: `### 1. 申领条件\r\n- 失业前用人单位和本人已经缴纳失业保险费满一年；\r\n- 非因本人意愿中断就业（如被辞退、合同到期等）；\r\n- 已经进行失业登记，并有求职要求。\r\n\r\n### 2. 申领渠道\r\n- **线上办理**：可以通过“电子社保卡”小程序、国家社会保险公共服务平台或当地人社部门官网/APP办理。\r\n- **线下办理**：携带身份证、社保卡前往参保地社保经办机构。\r\n\r\n### 3. 领取期限\r\n- 累计缴费满1年不足5年的，领取期限最长为12个月；\r\n- 满5年不足10年的，最长为18个月；\r\n- 10年以上的，最长为24个月。\r\n\r\n### 4. 待遇标准\r\n失业保险金标准通常为当地最低工资标准的80%-90%。领取期间，社保基金会代缴基本医疗保险费，个人无需缴纳。`\r\n  },\r\n  {\r\n    id: 'unemployment-calc',\r\n    title: '失业金领取计算器',\r\n    desc: '输入缴费年限，快速估算你可以领取的失业金总额及期限。',\r\n    tag: '实用工具',\r\n    isTool: true,\r\n    path: '/pages/guide/calculator/index'\r\n  },\r\n  {\r\n    id: 'social-security-strategy',\r\n    title: '个人就业缴社保攻略',\r\n    desc: '自由职业、灵活就业如何自己交社保？最全省钱攻略。',\r\n    tag: '办事指南',\r\n    isTool: true,\r\n    path: '/pages/guide/social-security/index'\r\n  },\r\n  {\r\n    id: 'unemployment-subsidy',\r\n    title: '失业补助金与临时生活补助',\r\n    desc: '针对不符合失业金领取条件的人员，还有哪些补助可以领？',\r\n    tag: '福利补贴',\r\n    content: `### 什么是失业补助金？\r\n失业补助金是针对领取失业保险金期满仍未就业的失业人员，以及不符合领取失业保险金条件的参保失业人员发放的临时性补贴。\r\n\r\n### 申领条件\r\n- 领取失业保险金期满仍未就业的失业人员；\r\n- 不符合领取失业保险金条件的参保失业人员（如缴费不满一年或主动辞职）。\r\n\r\n### 补贴标准\r\n具体标准由各地区根据实际情况确定，通常低于失业保险金。\r\n\r\n### 注意事项\r\n失业补助金只能申领一次，领取期间不享受失业保险其他待遇（如代缴医保）。`\r\n  },\r\n  {\r\n    id: 'skill-subsidy',\r\n    title: '技能提升补贴申领指南',\r\n    desc: '在职或失业期间考取职业资格证书，最高可领2000元。',\r\n    tag: '技能提升',\r\n    content: `### 补贴对象\r\n依法参加失业保险，累计缴纳失业保险费36个月（部分地区放宽至12个月）及以上的企业职工或领取失业金人员。\r\n\r\n### 补贴标准\r\n- **初级（五级）**：1000元\r\n- **中级（四级）**：1500元\r\n- **高级（三级）**：2000元\r\n\r\n### 申领流程\r\n取得证书之日起12个月内，通过当地人社部门官网 or APP在线申请。`\r\n  },\r\n  {\r\n    id: 'startup-loan',\r\n    title: '创业担保贷款政策',\r\n    desc: '想创业资金不足？了解一下政府贴息的创业担保贷款。',\r\n    tag: '创业支持',\r\n    content: `### 贷款对象\r\n城镇登记失业人员、就业困难人员、复员转业军人、高校毕业生等。\r\n\r\n### 贷款额度\r\n- **个人**：最高可申请20万元。\r\n- **合伙创业**：可根据合伙人数适当提高贷款额度。\r\n\r\n### 贴息政策\r\n政府将按规定给予贴息支持，个人只需承担较低比例的利息。\r\n\r\n### 申请条件\r\n除助学贷款、扶贫贷款、住房贷款、购车贷款、5万元以下小额消费贷款（含信用卡分期）外，申请人及其配偶应无其他贷款记录。`\r\n  }\r\n];\r\n","import { create } from 'zustand';\r\n\r\ninterface User {\r\n  id: number;\r\n  openId: string;\r\n  nickName: string;\r\n  avatarUrl: string;\r\n  userType: string;\r\n}\r\n\r\ninterface UserStore {\r\n  user: User | null;\r\n  isLoggedIn: boolean;\r\n  setUser: (user: User | null) => void;\r\n  clearUser: () => void;\r\n}\r\n\r\nexport const useUserStore = create<UserStore>((set) => ({\r\n  user: null,\r\n  isLoggedIn: false,\r\n  setUser: (user) => set({ user, isLoggedIn: !!user }),\r\n  clearUser: () => set({ user: null, isLoggedIn: false })\r\n}));\r\n"],"names":[],"ignoreList":[],"sourceRoot":""}