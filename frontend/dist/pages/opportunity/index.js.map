{"version":3,"file":"pages/opportunity/index.js","mappings":";;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;AC7RA;AAYA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack://zhuanjiao-yizhan-miniprogram/./src/pages/opportunity/index.tsx?813f","webpack://zhuanjiao-yizhan-miniprogram/._src_api_opportunity.ts","webpack://zhuanjiao-yizhan-miniprogram/._src_pages_opportunity_index.tsx"],"sourcesContent":["import _toConsumableArray from \"E:/Manus-Turning-Point-/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _regenerator from \"E:/Manus-Turning-Point-/frontend/node_modules/@babel/runtime/helpers/esm/regenerator.js\";\nimport _asyncToGenerator from \"E:/Manus-Turning-Point-/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _slicedToArray from \"E:/Manus-Turning-Point-/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport { View, Text, ScrollView, Picker } from '@tarojs/components';\nimport Taro from '@tarojs/taro';\nimport { useState, useEffect, useMemo } from 'react';\nimport { getOpportunityList } from '@/api/opportunity';\nimport './index.scss';\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nexport default function Opportunity() {\n  var _useState = useState([]),\n    _useState2 = _slicedToArray(_useState, 2),\n    opportunities = _useState2[0],\n    setOpportunities = _useState2[1];\n  var _useState3 = useState(true),\n    _useState4 = _slicedToArray(_useState3, 2),\n    loading = _useState4[0],\n    setLoading = _useState4[1];\n\n  // 筛选和排序状态\n  var _useState5 = useState('default'),\n    _useState6 = _slicedToArray(_useState5, 2),\n    sortType = _useState6[0],\n    setSortType = _useState6[1];\n  var _useState7 = useState('all'),\n    _useState8 = _slicedToArray(_useState7, 2),\n    difficultyFilter = _useState8[0],\n    setDifficultyFilter = _useState8[1];\n  var _useState9 = useState(''),\n    _useState0 = _slicedToArray(_useState9, 2),\n    searchKeyword = _useState0[0],\n    setSearchKeyword = _useState0[1];\n  useEffect(function () {\n    loadOpportunities();\n  }, []);\n  var loadOpportunities = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee() {\n      var data, _t;\n      return _regenerator().w(function (_context) {\n        while (1) switch (_context.p = _context.n) {\n          case 0:\n            _context.p = 0;\n            setLoading(true);\n            _context.n = 1;\n            return getOpportunityList();\n          case 1:\n            data = _context.v;\n            setOpportunities(data);\n            _context.n = 3;\n            break;\n          case 2:\n            _context.p = 2;\n            _t = _context.v;\n            Taro.showToast({\n              title: _t.message || '加载失败',\n              icon: 'none'\n            });\n          case 3:\n            _context.p = 3;\n            setLoading(false);\n            return _context.f(3);\n          case 4:\n            return _context.a(2);\n        }\n      }, _callee, null, [[0, 2, 3, 4]]);\n    }));\n    return function loadOpportunities() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  // 筛选和排序逻辑\n  var filteredAndSortedOpportunities = useMemo(function () {\n    var result = _toConsumableArray(opportunities);\n\n    // 1. 难度筛选\n    if (difficultyFilter !== 'all') {\n      result = result.filter(function (item) {\n        return item.difficulty === difficultyFilter;\n      });\n    }\n\n    // 2. 关键词搜索（标题或描述）\n    if (searchKeyword.trim()) {\n      var keyword = searchKeyword.toLowerCase();\n      result = result.filter(function (item) {\n        var _item$title, _item$description, _item$tags;\n        return ((_item$title = item.title) === null || _item$title === void 0 ? void 0 : _item$title.toLowerCase().includes(keyword)) || ((_item$description = item.description) === null || _item$description === void 0 ? void 0 : _item$description.toLowerCase().includes(keyword)) || ((_item$tags = item.tags) === null || _item$tags === void 0 ? void 0 : _item$tags.some(function (tag) {\n          return tag.toLowerCase().includes(keyword);\n        }));\n      });\n    }\n\n    // 3. 排序\n    if (sortType === 'difficulty') {\n      var difficultyOrder = {\n        easy: 1,\n        medium: 2,\n        hard: 3\n      };\n      result.sort(function (a, b) {\n        return difficultyOrder[a.difficulty] - difficultyOrder[b.difficulty];\n      });\n    } else if (sortType === 'income') {\n      // 按收入排序（假设收入格式为 \"¥1000-3000/月\"）\n      result.sort(function (a, b) {\n        var getIncomeValue = function getIncomeValue(income) {\n          var match = income.match(/\\d+/);\n          return match ? parseInt(match[0]) : 0;\n        };\n        return getIncomeValue(b.income) - getIncomeValue(a.income);\n      });\n    }\n    return result;\n  }, [opportunities, difficultyFilter, searchKeyword, sortType]);\n  var navigateToDetail = function navigateToDetail(id) {\n    Taro.navigateTo({\n      url: \"/pages/webview/index?url=/opportunity/\".concat(id)\n    });\n  };\n  var getDifficultyColor = function getDifficultyColor(difficulty) {\n    var colors = {\n      easy: '#10b981',\n      medium: '#f59e0b',\n      hard: '#ef4444'\n    };\n    return colors[difficulty] || '#6b7280';\n  };\n  var getDifficultyLabel = function getDifficultyLabel(difficulty) {\n    var labels = {\n      easy: '简单',\n      medium: '中等',\n      hard: '困难'\n    };\n    return labels[difficulty] || difficulty;\n  };\n\n  // 处理排序选择\n  var handleSortChange = function handleSortChange(e) {\n    var sortOptions = ['default', 'income', 'difficulty'];\n    setSortType(sortOptions[e.detail.value]);\n  };\n\n  // 处理难度筛选\n  var handleDifficultyChange = function handleDifficultyChange(e) {\n    var difficultyOptions = ['all', 'easy', 'medium', 'hard'];\n    setDifficultyFilter(difficultyOptions[e.detail.value]);\n  };\n  if (loading) {\n    return /*#__PURE__*/_jsx(View, {\n      className: \"opportunity-page\",\n      children: /*#__PURE__*/_jsx(View, {\n        className: \"loading\",\n        children: \"\\u52A0\\u8F7D\\u4E2D...\"\n      })\n    });\n  }\n  var sortOptions = ['默认排序', '收入从高到低', '难度从低到高'];\n  var difficultyOptions = ['全部难度', '简单', '中等', '困难'];\n  return /*#__PURE__*/_jsxs(ScrollView, {\n    className: \"opportunity-page\",\n    scrollY: true,\n    children: [/*#__PURE__*/_jsxs(View, {\n      className: \"header\",\n      children: [/*#__PURE__*/_jsx(Text, {\n        className: \"title\",\n        children: \"\\u526F\\u4E1A\\u673A\\u4F1A\"\n      }), /*#__PURE__*/_jsx(Text, {\n        className: \"subtitle\",\n        children: \"\\u53D1\\u73B0\\u9002\\u5408\\u4F60\\u7684\\u7075\\u6D3B\\u5C31\\u4E1A\\u673A\\u4F1A\"\n      })]\n    }), /*#__PURE__*/_jsxs(View, {\n      className: \"filter-bar\",\n      children: [/*#__PURE__*/_jsx(View, {\n        className: \"filter-item\",\n        children: /*#__PURE__*/_jsx(Picker, {\n          mode: \"selector\",\n          range: difficultyOptions,\n          onChange: handleDifficultyChange,\n          children: /*#__PURE__*/_jsxs(View, {\n            className: \"picker\",\n            children: [/*#__PURE__*/_jsx(Text, {\n              className: \"picker-text\",\n              children: difficultyOptions[['all', 'easy', 'medium', 'hard'].indexOf(difficultyFilter)]\n            }), /*#__PURE__*/_jsx(Text, {\n              className: \"picker-arrow\",\n              children: \"\\u25BC\"\n            })]\n          })\n        })\n      }), /*#__PURE__*/_jsx(View, {\n        className: \"filter-item\",\n        children: /*#__PURE__*/_jsx(Picker, {\n          mode: \"selector\",\n          range: sortOptions,\n          onChange: handleSortChange,\n          children: /*#__PURE__*/_jsxs(View, {\n            className: \"picker\",\n            children: [/*#__PURE__*/_jsx(Text, {\n              className: \"picker-text\",\n              children: sortOptions[['default', 'income', 'difficulty'].indexOf(sortType)]\n            }), /*#__PURE__*/_jsx(Text, {\n              className: \"picker-arrow\",\n              children: \"\\u25BC\"\n            })]\n          })\n        })\n      })]\n    }), /*#__PURE__*/_jsx(View, {\n      className: \"result-count\",\n      children: /*#__PURE__*/_jsxs(Text, {\n        children: [\"\\u5171 \", filteredAndSortedOpportunities.length, \" \\u4E2A\\u673A\\u4F1A\"]\n      })\n    }), /*#__PURE__*/_jsx(View, {\n      className: \"opportunity-list\",\n      children: filteredAndSortedOpportunities.map(function (item) {\n        return /*#__PURE__*/_jsxs(View, {\n          className: \"opportunity-card\",\n          onClick: function onClick() {\n            return navigateToDetail(item.id);\n          },\n          children: [/*#__PURE__*/_jsxs(View, {\n            className: \"card-header\",\n            children: [/*#__PURE__*/_jsx(Text, {\n              className: \"opportunity-title\",\n              children: item.title\n            }), item.isRecommended && /*#__PURE__*/_jsx(View, {\n              className: \"recommended-badge\",\n              children: \"\\u63A8\\u8350\"\n            })]\n          }), /*#__PURE__*/_jsx(Text, {\n            className: \"opportunity-desc\",\n            children: item.description\n          }), /*#__PURE__*/_jsxs(View, {\n            className: \"card-meta\",\n            children: [/*#__PURE__*/_jsxs(View, {\n              className: \"meta-item\",\n              children: [/*#__PURE__*/_jsx(Text, {\n                className: \"meta-label\",\n                children: \"\\u96BE\\u5EA6\"\n              }), /*#__PURE__*/_jsx(Text, {\n                className: \"meta-value\",\n                style: {\n                  color: getDifficultyColor(item.difficulty)\n                },\n                children: getDifficultyLabel(item.difficulty)\n              })]\n            }), /*#__PURE__*/_jsxs(View, {\n              className: \"meta-item\",\n              children: [/*#__PURE__*/_jsx(Text, {\n                className: \"meta-label\",\n                children: \"\\u6536\\u5165\"\n              }), /*#__PURE__*/_jsx(Text, {\n                className: \"meta-value income\",\n                children: item.income\n              })]\n            }), /*#__PURE__*/_jsxs(View, {\n              className: \"meta-item\",\n              children: [/*#__PURE__*/_jsx(Text, {\n                className: \"meta-label\",\n                children: \"\\u65F6\\u95F4\"\n              }), /*#__PURE__*/_jsx(Text, {\n                className: \"meta-value\",\n                children: item.timeCommitment\n              })]\n            })]\n          }), item.tags && item.tags.length > 0 && /*#__PURE__*/_jsx(View, {\n            className: \"tags\",\n            children: item.tags.map(function (tag, index) {\n              return /*#__PURE__*/_jsx(Text, {\n                className: \"tag\",\n                children: tag\n              }, index);\n            })\n          })]\n        }, item.id);\n      })\n    }), filteredAndSortedOpportunities.length === 0 && /*#__PURE__*/_jsx(View, {\n      className: \"empty\",\n      children: /*#__PURE__*/_jsx(Text, {\n        children: \"\\u6682\\u65E0\\u7B26\\u5408\\u6761\\u4EF6\\u7684\\u673A\\u4F1A\"\n      })\n    })]\n  });\n}","import { get } from './request';\r\n\r\nexport interface Opportunity {\r\n  id: number;\r\n  title: string;\r\n  description: string;\r\n  difficulty: 'easy' | 'medium' | 'hard';\r\n  income: string;\r\n  timeRequired: string;\r\n  tags: string[];\r\n}\r\n\r\n/**\r\n * 获取副业机会列表\r\n */\r\nexport function getOpportunityList() {\r\n  return get<Opportunity[]>('/api/trpc/opportunity.list');\r\n}\r\n\r\n/**\r\n * 获取推荐机会\r\n */\r\nexport function getRecommendedOpportunities() {\r\n  return get<Opportunity[]>('/api/trpc/opportunity.recommended');\r\n}\r\n","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"!!../../../node_modules/@tarojs/taro-loader/lib/entry-cache.js?name=pages/opportunity/index!./index.tsx\"\nvar config = {\"navigationBarTitleText\":\"副业机会\"};\n\n\nvar inst = Page(createPageConfig(component, 'pages/opportunity/index', {root:{cn:[]}}, config || {}))\n\n\nexport default component\n"],"names":[],"ignoreList":[],"sourceRoot":""}